<form id="right">
  <div ng-show="right">
    <div ng-cloak>
      <md-content>
        <md-tabs md-dynamic-height md-border-bottom class="md-primary">
          <md-tab label="import from excel to mongodb">
            <md-content class="md-padding" layout-xs="column" layout="row">
              <!-- left -->
              <div flex-xs flex-gt-xs="60" layout="column">
                <!-- <md-content class="md-padding"> -->
                <div class="conatiner">
                  <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-7">
                      <input
                        class="form-control"
                        type="file"
                        id="input"
                        accept=".xls,.xlsx"
                      />
                    </div>
                    <div class="col-md-2">
                      <button
                        class="btn btn-primary"
                        id="button"
                        ng-click="xlsx2json('#table1')"
                      >
                        Show in table
                      </button>
                    </div>

                    <div
                      id="table1"
                      style="
                        margin-top: 20px;
                        max-height: 80vh;
                        width: 57vw;
                        overflow-y: hidden;
                        overflow-x: hidden;
                      "
                    ></div>
                  </div>
                </div>
                <!-- </md-content> -->
              </div>
              <!-- right -->
              <div flex-xs flex-gt-xs="30" layout="column">
                <div class="column" ng-if="vm.showadd" style="margin-top: 20px">
                  <div>
                    <button
                      class="btn btn-primary"
                      id="button"
                      ng-click="save2db()"
                      style="margin-top: 15px; width: 200px"
                    >
                      save to database
                    </button>
                  </div>
                  <div class="textalert" style="margin-top: 20px">
                    {{notice}}
                  </div>
                </div>
              </div>
            </md-content>
          </md-tab>
          <md-tab
            label="ตรวจสอบ collection"
            ng-click="showcollection()"
            style="overflow-y: hidden"
          >
            <md-content class="md-padding" layout-xs="column" layout="row">
              <!-- left -->
              <div flex-xs flex-gt-xs="25" layout="column">
                <div
                  id="table2"
                  style="
                    margin-top: 20px;
                    max-height: 90vh;
                    width: 95%;
                    overflow-y: hidden;
                    overflow-x: hidden;
                  "
                ></div>
                <div style="width: 95%;max-height: 60vH;overflow-y: auto;">
                  <table
                    class="table table-striped table-condensed table-hover"
                  >
                    <tr ng-if="$index == 0" ng-repeat="detail in manacode">
                      <th
                        class="align-l marginleft15"
                        ng-repeat="(key, value) in detail"
                      >
                        {{key}}
                      </th>
                    </tr>
                    <tr ng-repeat="detail in manacode ">
                      <td
                        class="align-l marginleft15"
                        ng-repeat="(key, value) in detail"
                        ng-click="findvalue(value)"
                      >
                        {{value}}
                      </td>
                    </tr>
                  </table>
                <!-- </div>
                <div style="width: 95%"> -->
                  <table
                    class="table table-striped table-condensed table-hover"
                  >
                    <tr ng-if="$index == 0" ng-repeat="detail in mananame">
                      <th
                        class="align-l marginleft15"
                        ng-repeat="(key, value) in detail"
                      >
                        {{key}}
                      </th>
                    </tr>
                    <tr ng-repeat="detail in mananame ">
                      <td
                        class="align-l marginleft15"
                        ng-repeat="(key, value) in detail"
                        ng-click="findvalue(value)"
                      >
                        {{value}}
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
              <!-- right -->
              <div flex-xs flex-gt-xs="60" layout="column">
                <!-- <div flex layout="row"> -->
               
                <div
                  ng-if="itemcount != ''"
                  flex
                  layout="row"
                  style="justify-content: space-between;max-height: 50px;"
                >
                <div>{{vm.mfile}} {{itemcount}}</div>
                  <div>
                    <md-select
                      ng-model="vm.selectedDownload"
                      class=""
                      ng-change="downloadTypeChange(vm.selectedDownload)"
                    >
                      <md-option
                        ng-repeat="fileType in vm.downloadSupports"
                        ng-value="fileType"
                        ng-selected="fileType === vm.selectedDownload ? true: false"
                      >
                        {{fileType}}
                      </md-option>
                    </md-select>
                  </div>
                  <div>
                    <button
                      class="btn btn-default"
                      id="button1"
                      ng-click="downloadFile(vm.selectedDownload)"
                      style="width: 60px; height: 40px"
                    >
                      <img
                        src="../../app/image/download.png"
                        alt=""
                        style="width: 30px"
                      />
                    </button>
                  </div>
                  <div>
                    <button
                      class="btn btn-default"
                      id="button2"
                      ng-click="printFile()"
                      style="width: 60px; height: 40px"
                    >
                      <img
                        src="../../app/image/print.png"
                        alt=""
                        style="width: 30px"
                      />
                    </button>
                  </div>
                </div>
                <!-- </div> -->
                <div
                  id="table3"
                  style="
                    margin-top: 20px;
                    max-height: 75vh;
                    width: 67vw;
                    overflow-y: hidden;
                    overflow-x: hidden;
                  "
                ></div>
              </div>
            </md-content>
          </md-tab>
       
        </md-tabs>
      </md-content>
    </div>
  </div>
</form>
